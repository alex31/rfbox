
===================

Pour le mode paquet.

exemple message avec 1 float :
° serial frame
sync(2) len(1[v=4]) payload(4) crc(2)
° spi frame
len(1[v=6]) payload(4) crc(2)


==================================

FTDI JAUNE : RX (point de vue FTDI)
     ORANGE  TX

TODO :

//////////   TEST USB SERIE
En mode emission :
° brancher broche data câble gris->vert (entrée) sur (fil orange) d'un FTDI
° connecter ce FTDI (/dev/ttyUSB0)
° connecter la sortie FTDI de la rfbox sur le PC (/dev/ttyUSB1)
° lancer le test :
  * stty -F /dev/ttyUSB1 4800; cat < /dev/ttyUSB1
  * screen /dev/ttyUSB0 4800
//////////


0/ Initialisation
|1234567890123456|
------------------
|                |
|     RfBox      |
|                |
| initialisation |
------------------


1/ BE MCU goût emission : (rf disable, mode TX)
# NORF_TX
° si DIO2_DIRECT : buffer conf TX sinon : buffer conf HiZ
° RFM en mode sleep
° broche VCP_TX en input floating
|1234567890123456|
------------------
|TX RF:Off       |
|BE Emission     |
|mode USB-Série  |
|                |
------------------

2/ BE MCU goût reception : (rf disable, mode RX)
# NORF_RX
° si DIO2_DIRECT : buffer conf RX sinon : buffer conf HiZ
° RFM en mode sleep
° broche VCP_RX en input floating
° broche VCP_TX en output pushpull HI-SPEED
° ISR EXTI : surveille VCP_RX et recopie sur VCP_TX
|1234567890123456|
------------------
|RX RF:Off       |
|BE Reception    |
|mode USB-Série  |
|                |
------------------


3/ Reception source externe
# RF_RX_EXTERNAL
° buffer conf Rx (prise en compte INVERT_UART)
° RFM en mode RX
° broche VCP_TX en input floating
|1234567890123456|
------------------
|RX 868Mhz       |
|Source Externe  |
|Lna Gain -xxx   | -> xxx -> actual gain
|RSSI -xxx       | -> xxx -> actual RSSI level
------------------

4/ Emission source externe
# RF_TX_EXTERNAL
° buffer conf Tx (prise en compte INVERT_UART)
° RFM en mode TX
° broche VCP_TX en input floating
|1234567890123456|
------------------
|TX  868Mhz      |
|Source Externe  |
|Puissance: 13dbm|
|                |
------------------

5/ Reception source interne BER
# RF_RX_INTERNAL
° si DIO2_DIRECT : buffer conf HiZ sinon : buffer conf Rx (prise en compte INVERT_UART)
° RFM en mode RX
° broche VCP_TX en usart, mode swap, inversée ou non (macro à definir)
|1234567890123456|
------------------
|RX  868Mhz      |
|BER xxxx / 1000 | -> ou "no data" si aucune reception
|Lna -xxx  19200b| -> x -> A or F ; xxx -> actual gain
|RSSI -xxx       | actual RSSI level
------------------

6/ Emission source interne BER
# RF_TX_INTERNAL
°  si DIO2_DIRECT : buffer conf HiZ sinon : buffer conf Tx (prise en compte INVERT_UART)
   *** -> dans le cas ou on est pas en DIO2_DIRECT : vérification que source
   externe ne soit pas branchée
° RFM en mode TX
° broche VCP_TX en usart, pas de swap, inversée ou non (macro à definir)
|1234567890123456|
------------------
|TX 868Mhz       |
|Mode BER        |
|Puissance: 13dbm|
|19200 b         |
------------------



============
